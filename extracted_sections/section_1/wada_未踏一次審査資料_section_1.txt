1. プロジェクト名：機械学習に基づく中⼭間地域向け農業⽤散布ドローン群 申請者名：有⽥朋樹，和⽥唯我

1.  何をつくるか

1.1.  概要 : AgriSwarm

不整地における農業は，機械化が遅々として進まない領域である．特に，中⼭間地域におけるロボット開発は未だ
未発展であり，我々の知る限り，当地域へ特化した実⽤的なロボットは存在しない．中⼭間地域は果樹等の栽培に
とって重要であるが，斜⾯地や不整地などの地形は農業従事者に過酷な作業を強いる．そのため，機械による代替が
望まれているが，不整地での作業はロボットにおいても困難であるために，当領域の機械化は未だ挑戦的な課題であ
る．しかし近年，不整地における群制御 [1] および実環境に適⽤可能な機械学習⼿法における近年の研究成果によって
，この課題は解決可能になりつつある．そこで我々は，中⼭間地域での使⽤を想定した，⾼度な農作業を代替する⼩
型⾃律ドローン群システム AgriSwarm の開発を⾏う．本プロジェクトの⽬標は，果樹の棚下における⼈間の受粉作業
を AgriSwarm によって代替することである．このような技術の実応⽤例は，我々の知る限り未だ存在しない．
AgriSwarm は，機械学習に基づく花の姿勢推定，GPS に依らない⾼精度な⾃⼰位置推定，および⾼性能の制御プラン
ナで構成される．図 1 にシステム概要図およびデモの⼀部を⽰す．

図 1.  システム概要図  ( 左 )  デモの⼀部分 ( 右 )

1.1.1  現時点での進捗

はじめに複数の農家に聞き込みを⾏い，果樹の棚下での散布作業が⼀般的に存在するニーズであることを確認した
のち，図 1 に⽰したシステムの実装を⾏った．デモについては添付資料をご覧いただきたい．
ドローンの制御については，群制御に対応できる 3 次元経路計画アルゴリズム (Multi Agent Path Finding)  及び，カメ
ラ画像と IMU を⽤いた⾃⼰位置推定アルゴリズム (Visual Inertial Odometry) を実装した．画像認識技術については，花
の位置・姿勢推定モデルを構築した．更に，果樹の花には様々な種類が存在し各果樹種に対してそれぞれの位置・姿
勢推定モデルを学習させる必要があるため，NeRF を⽤いたアノテーションツールを開発した．また技術スタックの
検証のため，これらを統合したシミュレーション環境と，実機によるプロトタイプを作成し，実機については⼤熊町
の実証フィールドで試験⾶⾏・デモ動画の撮影を⾏った．残りのタスクについては 4 章を参照されたい．現時点までに
実装したソースコードは github で公開している．

1.2  社会的背景

⽇本の農業は従事者の減少と⾼齢化，資本集約が進まない特異な産業構造に
より，⻑きに渡って弱体化が進んできた．基幹的農業従事者は 2005 年から
2020 年の 15 年間で 38.5% 減少し，平均年齢は 64.3 歳から 67.8 歳に上昇している
[2,3,4]．しかし，近年になって漸く農業の⼯業化が起こり始め，農薬散布ド

ローンや貨物運搬ロボットといった新たな技術の導⼊による資本集約に伴い，競争⼒のある⾷農産業が⽣まれ始めて
いる．

こうした成功例の陰に潜む農業分野が中⼭間地域である．中⼭間地域は図 2 に⽰すように，⼭間地及びその周辺地域
の地理的条件が悪く，⼈⼿による農業作業が⾏いづらい地域を指す．  中⼭間地域は⼯作⾯積，農家数共に国内全体の 4
割を超え，⽇本特有の地形を⽣かした付加価値の⾼い農作物の⽣産に必要不可⽋な⼟地である  [2,3,4]．しかし，中⼭
間地域は⼤きな本質的問題を孕んでいる．すなわち，地⾯が険しい斜⾯地を成しているため⼈間が作業しづらく，テ
クノロジーを⽤いない⼈⼿作業だけでは⼤規模な耕作に不向きである．こうした問題を抱える⼀⽅で，中⼭間地域で
は，後述する理由により，未だテクノロジーの導⼊が進んでいない．実際，技術の導⼊が未発展なことも相まって，
中⼭間地域における耕作放棄は激しい．具体的には，平地に⽐べて⼯作放棄率は約 2 倍，⾼齢化率は 1.2~1.5 倍となっ
ており [2,3,4]，現在の中⼭間地域における産業の弱体化は喫緊の課題である．

1.3  技術的背景

「斜⾯地に適したロボット」として，⾃⾛式ロボット，⼤型ドローン，および⼩型ドローン群が選択肢に挙げられ
る．しかし，本プロジェクトを進めるうえで考慮すべき点として，「斜⾯地に適したロボット開発の困難性」および
「農家におけるシステムの導⼊コスト」が挙げられる．本プロジェクトでは，これらの観点から，⼩型ドローン群が
中⼭間地域における最適なソリューションであると考える．次⽂にて，その理由について前述の⼆点から説明する．

1.3.1  斜⾯地に適したロボット開発の困難性

斜⾯地に適したロボット開発は要求される難度が⾮常に⾼い．例えば，⾃⾛式ロボットは，中⼭間地域の斜⾯地に
おいて転倒せずに農作業を⾏わなければならず，当制御は技術的困難性が⾼いため実現が難しい．⼀⽅，ドローンの
導⼊は⼀⾒素直なアプローチに⾒えるものの，ドローン特有の問題を抱えている．例えば，既存の DJI など⼤⼿の農業
ドローンは稲作など広⼤な平⾯地帯を想定して開発されたために，斜⾯地での利⽤には適していない．

また，⽇本の中⼭間地域は果樹園など，⼤型化が困難な農業形態と密接
に関わっており，⼤型のドローンでは対処できない状況が多く存在する．
その⼀例に受粉作業や害⾍防除が挙げられる．受粉や防除作業は葉⾯や花
弁に対する直接的な散布を必要とする．しかし，棚を利⽤した果樹園では
，図 3 のような棚の下側から散布を⾏う必要があり，⼤型ドローンでは棚下
に潜り込んでの散布作業は不可能である．

上記に対し，⼩型ドローンは棚下に潜り込んで作業したり，葉⾯や花弁
に対する直接的な散布を実現することができる．このように，⼩型ドロー
ンは，受粉作業などにおいては⼤きな産業的価値がある．しかし，現状は
，前述の中⼭間地域における問題が⽇本に特有のものであるために，未だ
技術開発が進んでいない．

1.3.2  農家におけるシステムの導⼊コスト

次に，農家におけるシステムの導⼊コストについて考える．まず，⽇本の分割された個々の農家規模に対して  ，ロ
ボット導⼊は莫⼤な費⽤を要する．現状では，地域の農家が共同で農業機械を購⼊し，貸し合うことで農業ロボット
の恩恵を受けている地域も⾒られるものの，個々⼈が⾃分の意思で農業投資を⾏うことは未だ困難である．この観点
からも，より安価で逐次投⼊できる⼩型農業ロボットの形が求められていると⾔える．

⼀⽅，近年の研究成果によって，不整地環境においても，安価な⼩型ドローン群を⾃律制御できる技術基盤が整い
つつある．具体的には，GPS を⽤いずに RGB 画像と IMU から⾃⼰位置推定を⾏う VIO (Visual  Inertial Odometry)  が現
実的な⾃⼰位置推定⼿法になり，それに伴い，不整地環境においても，複数のエージェントが動的な障害物に衝突せ
ず追従可能な軌道を三次元上で計画することが可能になってきている．また，画像処理における機械学習技術の進歩
によって，⼈間の認知に代替しうるアルゴリズムの開発が容易になりつつある．

1.4  現場の声

本プロジェクトの需要ならびに社会的インパクトを検証するため，株式会社 ReFruits 様のご協⼒の元，農業法⼈の
関係者および複数の農家に聞き込みを⾏った．以下は聞き込みにご協⼒頂いた⽅の現場の声の⼀例である．

●  A さん
  ○  受粉は実施できる期間が限られ短期間のみ ( 満開は 3~5 ⽇ ) の⼤量の雇⽤が発⽣する
  ○  各年気候によって受粉作業が⾏える時期が異なるため，雇⽤時期が予想できない

●  B さん
  ○  ひたすら花に棒で花粉をつけるという退屈な作業
  ○  受粉という単⼀の作業のために，果樹栽培全体のハードルが上がってしまっている

●  C さん
  ○  震災前は地元のおばちゃんたちをパートで取って，地域で助け合いながらやっていたが，震災後⻑期
     の避難指⽰で地域コミュニティは喪失，⼈⼝もまだ⾮常に少なくパートで取るのは難しい

上記より，受粉作業の効率化・ドローンによる代替は⼀定のニーズがあることが確認できる．

1.5  提案 : AgriSwarm

これらの社会的・技術的背景から，本プロジェクトでは，中⼭間地域向け農業⽤散布ドローン群システム
AgriSwarm を提案する．本システムは，⾼度なドローン群制御によってドローンを⾃律的に動作させ，機械学習に基
づく花の姿勢推定によって検出した花の向きに，ドローンから花粉を散布することで，斜⾯地を含む不整地および果
樹棚下における受粉作業を代替することを⽬的とする．

Agriswarm のシステムは次に⽰す 3 つの主要技術によって構成される．①制御  (ソフトウェア) 「機械学習に基づく花
の位置・姿勢の推定」「VIO(VIsual Inertial Odometry) による⾃⼰位置の推定」「3 次元環境地図の作成」「群制御プ
ランナによる経路計画」「フライトコントローラによる計画軌道の実現」②機構・電装  (ハードウェア) 「CPU  / GPU
」「FCU (Flight Control Unit)」「モノクロステレオビジョンカメラ /RGB カメラ」「花粉を散布する機構」③シミュ
レーション (SITL)．

1.5.1  制御

図 4 にて，実機制御におけるシステム概要図を⽰す．

図 4.  実機制御におけるシステム概要図

1.5.1.1  機械学習による花の位置・姿勢の推定

カメラから得られた花の RGB 画像と深度情報から 3 次元世界座標系における花の位置・姿勢を推定する技術 ( 図 4
FlowerDetector/EstimateManager) を開発した．本技術は Head Pose Estimation (HPE) に基づいており，具体的には図

5 に⽰す TokenHPE [5] をベースに花の姿勢を推定する．HPE とは，図 5 に⽰すように，⼈間の頭部の⽅向を推定する技
術である．

図 5. TokenHPE [5] のアーキテクチャ図  ( 左 ) Head Pose Estimation [6] の例  ( 右 )

また，果樹の花には様々な種類が存在し各果樹種に対してそれぞれの
位置・姿勢推定モデルを学習させる必要がある．この際，姿勢のアノ
テーションコストは⾮常に⾼く，2 次元画像から姿勢を⼀枚⼀枚アノテー
ションするのは time-consuming である．そのため，本プロジェクトでは
，NeRF [7]  により 3D モデルを作成し，当 3D モデルに三次元のアノテー
ションを⾏うことで，⼆次元画像に対するオイラー⾓を⼤量にアノテー
ションするツールを作成した．( 図 6)

1.5.1.2 VIO(VIsual Inertial Odometry) による⾃⼰位置の推定

多くのドローンは GPS を⽤いて⾃⼰位置を取得するが，1cm 単位の正確性を必要とする不整地環境では，GPS に依
らない⾃⼰位置推定アルゴリズムが必要である．VIO(Visual Inertial Odometry) はカメラ画像から取得した特徴点の変
移と IMU データを利⽤して SE(3) の最適化問題を解くことで，3 次元座標系におけるドローンの並進と回転を推定する
ことができる ( 図 5 Visual Inertial Odometry)

1.5.1.3  三次元環境地図の作成

カメラから得られた RGB 画像と深度情報，VIO によって推定された⾃⼰位置から，障害物を 3 次元上にマッピングし
，ボクセルで表現された環境地図を作成する ( 図 4 Grid Map)．環境地図の作成は⾃⼰位置の推定と合わせて Visual
SLAM と呼ばれ，⼩型ドローンには必要不可⽋な技術である．

1.5.1.4  群制御プランナによる経路計画

Visual SLAM によって推定された⾃⼰位置と環境地図から，任意の座標に到達するための軌道を⽣成するプランナ
を実装した ( 図 4 Multi Agent Path Finding)．計画された軌道は，草⽊や果樹棚などの障害物を避け，他ドローンと衝
突せずに，⾮ホロノミックなドローンが追従可能であるような軌道でなければならない．これらの要求を満たす経路
計画のアルゴリズムの実現は近年の研究成果が可能にした⽬覚ましい発展のうちの⼀つである．

1.5.1.5  フライトコントローラによる計画軌道の実現

オープンソースのフライトコントローラーを使⽤する．OSS のフライトコントローラーは Ardupilot や PX4 などいく
つか存在するが，シミュレーション環境との互換性やカスタマイズ性から，Agriswarm では Ardupilot を使⽤する．

1.5.2  シミュレーション  (SITL; Simulation In The Loop)

上記に⽰した制御スタックの検証のために，物理シミュレータである Gazebo 上で Ardupilot フライトコントローラを
搭載したドローンを制御できる SITL(Simulation In The Loop) 環境を実装した ( 図 7)．シミュレーション環境は少ないパ
ラメータで実機環境と交換可能であるため，容易に各種制御プランナの検証を⾏うことが可能である．

図 7. SITL(Simulation In The Loop) 環境の概略図

1.5.3  機構・電装

1.5.3.1 CPU / GPU: Jetson Xavier NX

VIO をはじめとした⾼度かつリアルタイム性が求められる制御を⾏うた
めには，オンボードの計算資源が⼗分で無ければならない．Agriswarm に
は組み込み⽤の cpu/gpu モジュールである Jetson Xavier NX を搭載する．プ
ロトタイプにおいては，図 8 に⽰すように VTX( 映像伝送⽤送信機 ) を⽤いて
カメラ映像を⼿元の Linux pc に伝送することで，Linux pc の計算資源を使い
，不完全ながらリアルタイム制御を達成している．

1.5.3.2 FCU (Flight Control Unit): STM32H725VGT6

低レイヤの⾶⾏制御にはそれに特化した計算機による実装環境が充実し
ているため，FCU は cpu/gpu とは別に必要である．プロトタイプにおいては STM32F405 を⽤いている．

1.5.3.3  ステレオビジョンカメラ /RGB  カメラ : realsense d435

深度情報を取得するためにはいくつかの⼿法が存在するが，ステレオビジョンカメラは軽量かつ⾼性能に深度を測
ることができる．Agriswarm では，realsense d435 を搭載する．プロトタイプにおいては，RGB カメラ (Runcam
Nano4) で得た画像情報から深度を推定することで，不完全ながら深度情報を取得している ( 図 4 DepthEstimator)．

1.5.3.3  花粉を散布する機構

従来，⼈⼿による受粉作業では，棒の先に花粉がついた綿などを巻き付け，接触によって受粉を⾏う⽅法と，霧吹
きなどの散布機構で花粉の溶液を吹き付ける⽅法が存在している．現在では接触感染する病気を予防する⽬的などか
ら後者の散布⼿法が好まれているが，いずれにしても従来の機構を電気制御可能に改造することで実現可能であると
考えられる．
