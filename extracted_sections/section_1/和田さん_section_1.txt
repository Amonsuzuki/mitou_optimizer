1.   概 要 : AgriSwarm  不 整 地 における 農 業 は ， 機 械化 が 遅 々 として 進 まない 領 域 である ． 特 に ， 中 ⼭ 間 地 域 におけるロボット 開 発 は 未 だ  未 発 展 であり ， 我 々 の 知 る 限 り ， 当 地 域 へ 特 化 した 実 ⽤ 的 なロボットは 存 在 しない ． 中 ⼭ 間 地 域 は 果 樹 等 の 栽 培 に  とって 重 要 であるが ， 斜 ⾯ 地 や 不 整 地 などの 地 形 は 農 業 従 事 者 に 過 酷 な 作 業 を 強 いる ． そのため ， 機 械 による 代替 が  望 まれているが ， 不 整 地 での 作 業 はロボットにおいても 困 難 であるために ， 当 領 域 の 機 械化 は 未 だ 挑 戦 的 な 課 題 であ  る ． しかし 近 年 ， 不 整 地 における 群 制 御 [1] および 実 環境 に 適 ⽤ 可 能 な 機 械学 習 ⼿ 法 における 近 年 の 研 究 成 果 によって  ， この 課 題 は 解 決 可 能 になりつつある ． そこで 我 々 は ， 中 ⼭ 間 地 域 での 使 ⽤ を 想 定 した ， ⾼ 度 な 農 作 業 を 代替 す る ⼩  型 ⾃ 律 ドロ ー ン 群 システム AgriSwarm の 開 発 を ⾏ う ． 本 プロジェクトの ⽬ 標 は ， 果 樹 の 棚 下 における ⼈ 間 の 受 粉 作 業  を AgriSwarm によって 代替 することである ． このような 技 術 の 実 応 ⽤ 例 は ， 我 々 の 知 る 限 り 未 だ 存 在 し ない ．  AgriSwarm は ， 機 械学 習 に 基 づく 花 の 姿 勢推 定 ， GPS に 依 らない ⾼ 精 度 な ⾃ ⼰ 位 置 推 定 ， および ⾼ 性 能 の 制 御 プラン  ナで 構 成 される ． 図 1 にシステム 概 要 図 およびデモの ⼀ 部 を ⽰ す ．  図
1.   システム 概 要 図   ( 左 )   デモの ⼀ 部 分 ( 右 )  1.1.1   現 時 点 での 進 捗  はじめに 複 数 の 農 家 に 聞 き 込 みを ⾏ い ， 果 樹 の 棚 下 での 散 布 作 業 が ⼀ 般 的 に 存 在 するニ ー ズであることを 確 認 した  のち ， 図 1 に ⽰ したシステムの 実 装 を ⾏ った ． デモについては 添 付 資 料 をご 覧 いただきたい ．  ドロ ー ンの 制 御 については ， 群 制 御 に 対 応 できる 3 次 元経 路 計 画 アルゴリズム (Multi Agent Path Finding)   及 び ， カメ  ラ 画 像 と IMU を ⽤ いた ⾃ ⼰ 位 置 推 定 アルゴリズム (Visual Inertial Odometry) を 実 装 した ． 画 像 認 識 技 術 については ， 花  の 位 置 ・ 姿 勢推 定 モデルを 構 築 した ． 更 に ， 果 樹 の 花 には 様 々 な 種 類 が 存 在 し 各果 樹種 に 対 してそれぞれの 位 置 ・ 姿  勢推 定 モデルを 学 習 させる 必 要 があるため ， NeRF を ⽤ いたアノテ ー ションツ ー ルを 開 発 した ． また 技 術 スタックの  検 証 のため ， これらを 統 合 したシミュレ ー ション 環境 と ， 実 機 によるプロトタイプを 作 成 し ， 実 機 については ⼤ 熊 町  の 実 証 フィ ー ルドで 試 験 ⾶ ⾏ ・ デモ 動 画 の 撮 影 を ⾏ った ． 残 りのタスクについては 4 章 を 参 照 されたい ． 現 時 点 までに  実 装 したソ ー スコ ー ドは github で 公 開 している ．  1.2   社 会 的 背 景  ⽇ 本 の 農 業 は 従 事 者 の 減 少 と ⾼ 齢 化 ， 資 本 集 約 が 進 まない 特 異 な 産 業 構 造 に  より ， ⻑ きに 渡 って 弱 体 化 が 進 んできた ． 基 幹 的 農 業 従 事 者 は 2005 年 から  2020 年 の 15 年 間 で 38.5% 減 少 し ， 平 均 年 齢 は 64.3 歳 から 67.8 歳 に 上昇 している  [2,3,4] ． しかし ， 近 年 になって 漸 く 農 業 の ⼯ 業 化 が 起 こり 始 め ， 農 薬 散 布 ド
ロ ー ンや 貨 物 運 搬 ロボットといった 新 たな 技 術 の 導 ⼊ による 資 本 集 約 に 伴 い ， 競 争 ⼒ のある ⾷ 農 産 業 が ⽣ まれ 始 めて  いる ．  こうした 成 功 例 の 陰 に 潜 む 農 業 分 野 が 中 ⼭ 間 地 域 である ． 中 ⼭ 間 地 域 は 図 2 に ⽰ すように ， ⼭ 間 地 及 びその 周 辺 地 域  の 地 理 的 条 件 が 悪 く ， ⼈ ⼿ による 農 業 作 業 が ⾏ いづらい 地 域 を 指 す ．   中 ⼭ 間 地 域 は ⼯ 作 ⾯ 積 ， 農 家 数 共 に 国 内 全 体 の 4  割 を 超 え ， ⽇ 本 特 有 の 地 形 を ⽣ かした 付 加価 値 の ⾼ い 農 作 物 の ⽣ 産 に 必 要 不 可 ⽋ な ⼟ 地 である   [2,3,4] ． しかし ， 中 ⼭  間 地 域 は ⼤ きな 本 質 的 問 題 を 孕 んでいる ． すなわち ， 地 ⾯ が 険 しい 斜 ⾯ 地 を 成 しているため ⼈ 間 が 作 業 しづらく ， テ  クノロジ ー を ⽤ いない ⼈ ⼿ 作 業 だけでは ⼤ 規 模 な 耕 作 に 不 向 きである ． こうした 問 題 を 抱 える ⼀ ⽅ で ， 中 ⼭ 間 地 域 で  は ， 後 述 する 理由 により ， 未 だテクノロジ ー の 導 ⼊ が 進 んでいない ． 実際 ， 技 術 の 導 ⼊ が 未 発 展 なことも 相 まって ，  中 ⼭ 間 地 域 における 耕 作 放 棄 は 激 しい ． 具 体 的 には ， 平 地 に ⽐ べて ⼯ 作 放 棄 率 は 約 2 倍 ， ⾼ 齢 化 率 は 1.2~1.5 倍 となっ  ており [2,3,4] ， 現 在 の 中 ⼭ 間 地 域 における 産 業 の 弱 体 化 は 喫緊 の 課 題 である ．  1.3   技 術 的 背 景  「 斜 ⾯ 地 に 適 したロボット 」 として ， ⾃ ⾛ 式 ロボット ， ⼤ 型 ドロ ー ン ， および ⼩ 型 ドロ ー ン 群 が 選 択 肢 に 挙 げ られ  る ． しかし ， 本 プロジェクトを 進 めるうえで 考 慮 すべき 点 として ，「 斜 ⾯ 地 に 適 したロボット 開 発 の 困 難 性 」 および  「 農 家 におけるシステムの 導 ⼊ コスト 」 が 挙 げられる ． 本 プロジェクトでは ， これらの 観 点 から ， ⼩ 型 ドロ ー ン 群 が  中 ⼭ 間 地 域 における 最 適 なソリュ ー ションである と 考 える ． 次 ⽂ にて ， その 理由 について 前 述 の ⼆ 点 から 説 明 する ．  1.3.1   斜 ⾯ 地 に 適 したロボット 開 発 の 困 難 性  斜 ⾯ 地 に 適 したロボット 開 発 は 要 求 される 難度 が ⾮ 常 に ⾼ い ． 例 えば ， ⾃ ⾛ 式 ロボットは ， 中 ⼭ 間 地 域 の 斜 ⾯ 地 に  おいて 転倒 せずに 農 作 業 を ⾏ わなければならず ， 当 制 御 は 技 術 的 困 難 性 が ⾼ いため 実 現 が 難 しい ． ⼀ ⽅ ， ドロ ー ンの  導 ⼊ は ⼀ ⾒ 素 直 なアプロ ー チに ⾒ えるものの ， ドロ ー ン 特 有 の 問 題 を 抱 えている ． 例 えば ， 既 存 の DJI など ⼤ ⼿ の 農 業  ドロ ー ンは 稲 作 など 広 ⼤ な 平 ⾯ 地帯 を 想 定 して 開 発 されたために ， 斜 ⾯ 地 での 利 ⽤ には 適 していない ．  また ， ⽇ 本 の 中 ⼭ 間 地 域 は 果 樹 園 など ， ⼤ 型 化 が 困 難 な 農 業 形 態 と 密 接  に 関 わっており ， ⼤ 型 のドロ ー ンでは 対 処 できない 状 況 が 多 く 存 在 する ．  その ⼀ 例 に 受 粉 作 業 や 害 ⾍ 防 除 が 挙 げられる ． 受 粉 や 防 除 作 業 は 葉 ⾯ や 花  弁 に 対 する 直 接 的 な 散 布 を 必 要 とする ． しかし ， 棚 を 利 ⽤ した 果 樹 園 では  ， 図 3 のような 棚 の 下 側 から 散 布 を ⾏ う 必 要 があり ， ⼤ 型 ドロ ー ンでは 棚 下  に 潜 り 込 んでの 散 布 作 業 は 不 可 能 である ．  上 記 に 対 し ， ⼩ 型 ドロ ー ンは 棚 下 に 潜 り 込 んで 作 業 したり ， 葉 ⾯ や 花 弁  に 対 する 直 接 的 な 散 布 を 実 現 することができる ． このように ， ⼩ 型 ドロ ー  ンは ， 受 粉 作 業 などにおいては ⼤ きな 産 業 的 価 値 がある ． しかし ， 現 状 は  ， 前 述 の 中 ⼭ 間 地 域 における 問 題 が ⽇ 本 に 特 有 のものであるために ， 未 だ  技 術 開 発 が 進 んでいない ．  1.3.2   農 家 におけるシステムの 導 ⼊ コスト  次 に ， 農 家 におけるシステムの 導 ⼊ コストについて 考 える ． まず ， ⽇ 本 の 分 割 された 個 々 の 農 家 規 模 に 対 して   ， ロ  ボット 導 ⼊ は 莫 ⼤ な 費 ⽤ を 要 する ． 現 状 では ， 地 域 の 農 家 が 共 同 で 農 業機 械 を 購 ⼊ し ， 貸 し 合 うことで 農 業 ロボット  の 恩 恵 を 受 けている 地 域 も ⾒ られるものの ， 個 々 ⼈ が ⾃ 分 の 意 思 で 農 業 投 資 を ⾏ うことは 未 だ 困 難 である ． この 観 点  からも ， より 安 価 で 逐 次 投 ⼊ できる ⼩ 型 農 業 ロボットの 形 が 求 められていると ⾔ える ．  ⼀ ⽅ ， 近 年 の 研 究 成 果 によって ， 不 整 地 環境 においても ， 安 価 な ⼩ 型 ドロ ー ン 群 を ⾃ 律 制 御 できる 技 術 基 盤 が 整 い  つつある ． 具 体 的 には ， GPS を ⽤ いずに RGB 画 像 と IMU から ⾃ ⼰ 位 置 推 定 を ⾏ う VIO (Visual   Inertial Odometry)   が 現  実 的 な ⾃ ⼰ 位 置 推 定 ⼿ 法 になり ， それに 伴 い ， 不 整 地 環境 においても ， 複 数 のエ ー ジェントが 動的 な 障 害 物 に 衝 突 せ  ず 追 従 可 能 な 軌 道 を 三次 元 上 で 計 画 することが 可 能 になってきている ． また ， 画 像 処 理 における 機 械学 習 技 術 の 進 歩  によって ， ⼈ 間 の 認 知 に 代替 しうるアルゴリズムの 開 発 が 容 易 になりつつある ．  1.4   現 場 の 声  本 プロジェクトの 需 要 ならびに 社 会 的 インパクトを 検 証 するため ， 株 式 会 社 ReFruits 様 のご 協 ⼒ の 元 ， 農 業 法 ⼈ の  関 係 者 および 複 数 の 農 家 に 聞 き 込 みを ⾏ った ． 以 下 は 聞 き 込 みにご 協 ⼒ 頂 いた ⽅ の 現 場 の 声 の ⼀ 例 である ．  ●   A さん  ○   受 粉 は 実施 できる 期間 が 限 られ 短 期間 のみ ( 満 開 は 3~5 ⽇ ) の ⼤ 量 の 雇 ⽤ が 発 ⽣ する  ○   各 年 気 候 によって 受 粉 作 業 が ⾏ える 時 期 が 異 なるため ， 雇 ⽤ 時 期 が 予 想 できない
●   B さん  ○   ひたすら 花 に 棒 で 花 粉 をつけるという 退 屈 な 作 業  ○   受 粉 という 単 ⼀ の 作 業 のために ， 果 樹 栽 培 全 体 のハ ー ドルが 上 がってしまっている  ●   C さん  ○   震 災 前 は 地 元 のおばちゃんたちをパ ー トで 取 って ， 地 域 で 助 け 合 いながらやっていたが ， 震 災 後 ⻑ 期  の 避 難 指 ⽰ で 地 域 コミュニティは 喪 失 ， ⼈ ⼝ もまだ ⾮ 常 に 少 なくパ ー トで 取 るのは 難 しい  上 記 より ， 受 粉 作 業 の 効 率 化 ・ ドロ ー ンによる 代替 は ⼀ 定 のニ ー ズがあることが 確 認 できる ．  1.5   提 案 : AgriSwarm  これらの 社 会 的 ・ 技 術 的 背 景 から ， 本 プロジェクトでは ， 中 ⼭ 間 地 域 向 け 農 業 ⽤ 散 布 ドロ ー ン 群 システム  AgriSwarm を 提 案 する ． 本 システムは ， ⾼ 度 なドロ ー ン 群 制 御 によってドロ ー ンを ⾃ 律 的 に 動 作 させ ， 機 械学 習 に 基  づく 花 の 姿 勢推 定 によって 検 出 した 花 の 向 きに ， ドロ ー ンから 花 粉 を 散 布 することで ， 斜 ⾯ 地 を 含 む 不 整 地 および 果  樹 棚 下 における 受 粉 作 業 を 代替 することを ⽬ 的 とする ．  Agriswarm のシステムは 次 に ⽰ す 3 つの 主 要 技 術 によって 構 成 される ． ① 制 御   ( ソフトウェア ) 「 機 械学 習 に 基 づく 花  の 位 置 ・ 姿 勢 の 推 定 」「 VIO(VIsual Inertial Odometry) による ⾃ ⼰ 位 置 の 推 定 」「 3 次 元 環境 地 図 の 作 成 」「 群 制 御 プ  ランナによる 経 路 計 画 」「 フライトコントロ ー ラによる 計 画 軌 道 の 実 現 」 ② 機 構 ・ 電 装   ( ハ ー ドウェア ) 「 CPU   / GPU  」「 FCU (Flight Control Unit) 」「 モノクロステレオビジョンカメラ /RGB カメラ 」「 花 粉 を 散 布 する 機 構 」 ③ シミュ  レ ー ション (SITL) ．  1.5.1   制 御  図 4 にて ， 実 機 制 御 におけるシステム 概 要 図 を ⽰ す ．  図
4.   実 機 制 御 におけるシステム 概 要 図  1.5.1.1   機 械学 習 による 花 の 位 置 ・ 姿 勢 の 推 定  カメラから 得 られた 花 の RGB 画 像 と 深 度 情 報 から 3 次 元 世 界 座 標 系 における 花 の 位 置 ・ 姿 勢 を 推 定 する 技 術 ( 図 4  FlowerDetector/EstimateManager) を 開 発 した ． 本 技 術 は Head Pose Estimation (HPE) に 基 づいており ， 具 体 的 には 図
5 に ⽰ す TokenHPE [5] をベ ー スに 花 の 姿 勢 を 推 定 する ． HPE とは ， 図 5 に ⽰ すように ， ⼈ 間 の 頭 部 の ⽅ 向 を 推 定 する 技  術 である ．  図
5. TokenHPE [5] のア ー キテクチャ 図   ( 左 ) Head Pose Estimation [6] の 例   ( 右 )  また ， 果 樹 の 花 には 様 々 な 種 類 が 存 在 し 各果 樹種 に 対 してそれぞれの  位 置 ・ 姿 勢推 定 モデルを 学 習 させる 必 要 がある ． この 際 ， 姿 勢 のアノ  テ ー ションコストは ⾮ 常 に ⾼ く ， 2 次 元 画 像 から 姿 勢 を ⼀ 枚 ⼀ 枚 アノテ ー  ションするのは time-consuming である ． そのため ， 本 プロジェクトでは  ， NeRF [7]   により 3D モデルを 作 成 し ， 当 3D モデルに 三次 元 のアノテ ー  ションを ⾏ うことで ， ⼆ 次 元 画 像 に 対 するオイラ ー ⾓ を ⼤ 量 にアノテ ー  ションするツ ー ルを 作 成 した ． ( 図 6)  1.5.1.2 VIO(VIsual Inertial Odometry) による ⾃ ⼰ 位 置 の 推 定  多 くのドロ ー ンは GPS を ⽤ いて ⾃ ⼰ 位 置 を 取 得 するが ， 1cm 単 位 の 正 確 性 を 必 要 とする 不 整 地 環境 では ， GPS に 依  らない ⾃ ⼰ 位 置 推 定 アルゴリズムが 必 要 である ． VIO(Visual Inertial Odometry) はカメラ 画 像 から 取 得 した 特 徴 点 の 変  移 と IMU デ ー タを 利 ⽤ して SE(3) の 最 適 化 問 題 を 解 くことで ， 3 次 元 座 標 系 におけるドロ ー ンの 並 進 と 回 転 を 推 定 する  ことができる ( 図 5 Visual Inertial Odometry)  1.5.1.3   三次 元 環境 地 図 の 作 成  カメラから 得 られた RGB 画 像 と 深 度 情 報 ， VIO によって 推 定 された ⾃ ⼰ 位 置 から ， 障 害 物 を 3 次 元 上 にマッピングし  ， ボクセルで 表 現 された 環境 地 図 を 作 成 する ( 図 4 Grid Map) ． 環境 地 図 の 作 成 は ⾃ ⼰ 位 置 の 推 定 と 合 わせて Visual  SLAM と 呼 ばれ ， ⼩ 型 ドロ ー ンには 必 要 不 可 ⽋ な 技 術 である ．  1.5.1.4   群 制 御 プランナによる 経 路 計 画  Visual SLAM によって 推 定 された ⾃ ⼰ 位 置 と 環境 地 図 から ， 任 意 の 座 標 に 到 達 するための 軌 道 を ⽣ 成 するプランナ  を 実 装 した ( 図 4 Multi Agent Path Finding) ． 計 画 された 軌 道 は ， 草 ⽊ や 果 樹 棚 などの 障 害 物 を 避 け ， 他 ドロ ー ンと 衝  突 せずに ， ⾮ ホロノミックなドロ ー ンが 追 従 可 能 であるような 軌 道 でなければならない ． これらの 要 求 を 満 たす 経 路  計 画 のアルゴリズムの 実 現 は 近 年 の 研 究 成 果 が 可 能 にした ⽬ 覚 ましい 発 展 のうちの ⼀ つである ．  1.5.1.5   フライトコントロ ー ラによる 計 画 軌 道 の 実 現  オ ー プンソ ー スのフライトコントロ ー ラ ー を 使 ⽤ する ． OSS のフライトコントロ ー ラ ー は Ardupilot や PX4 などいく  つか 存 在 するが ， シミュレ ー ション 環境 との 互 換 性 やカスタマイズ 性 から ， Agriswarm では Ardupilot を 使 ⽤ する ．  1.5.2   シミュレ ー ション   (SITL; Simulation In The Loop)
上 記 に ⽰ した 制 御 スタックの 検 証 のために ， 物 理 シミュレ ー タである Gazebo 上 で Ardupilot フライトコントロ ー ラを  搭 載 したドロ ー ンを 制 御 できる SITL(Simulation In The Loop) 環境 を 実 装 した ( 図 7) ． シミュレ ー ション 環境 は 少 ないパ  ラメ ー タで 実 機環境 と 交 換可 能 であるため ， 容 易 に 各 種 制 御 プランナの 検 証 を ⾏ うことが 可 能 である ．  図
7. SITL(Simulation In The Loop) 環境 の 概 略 図  1.5.3   機 構 ・ 電 装  1.5.3.1 CPU / GPU: Jetson Xavier NX  VIO をはじめとした ⾼ 度 かつリアルタイム 性 が 求 められる 制 御 を ⾏ うた  めには ， オンボ ー ドの 計 算資 源 が ⼗ 分 で 無 ければならない ． Agriswarm に  は 組 み 込 み ⽤ の cpu/gpu モジュ ー ルである Jetson Xavier NX を 搭 載 する ． プ  ロトタイプにおいては ， 図 8 に ⽰ すように VTX( 映 像 伝 送 ⽤ 送 信 機 ) を ⽤ いて  カメラ 映 像 を ⼿ 元 の Linux pc に 伝 送 することで ， Linux pc の 計 算資 源 を 使 い  ， 不 完 全 ながらリアルタイム 制 御 を 達 成 している ．  1.5.3.2 FCU (Flight Control Unit): STM32H725VGT6  低 レイヤの ⾶ ⾏ 制 御 にはそれに 特 化 した 計 算 機 による 実 装 環境 が 充 実 し  ているため ， FCU は cpu/gpu とは 別 に 必 要 である ． プロトタイプにおいては STM32F405 を ⽤ いている ．  1.5.3.3   ステレオビジョンカメラ /RGB   カメラ : realsense d435  深 度 情 報 を 取 得 するためにはいくつかの ⼿ 法 が 存 在 するが ， ステレオビジョンカメラは 軽 量 かつ ⾼ 性 能 に 深 度 を 測  ることができる ． Agriswarm では ， realsense d435 を 搭 載 する ． プロトタイプにおいては ， RGB カメラ (Runcam  Nano4) で 得 た 画 像 情 報 から 深 度 を 推 定 することで ， 不 完 全 ながら 深 度 情 報 を 取 得 している ( 図 4 DepthEstimator) ．
1.5.3.3   花 粉 を 散 布 する 機 構  従 来 ， ⼈ ⼿ による 受 粉 作 業 では ， 棒 の 先 に 花 粉 がついた 綿 などを 巻 き 付 け ， 接 触 によって 受 粉 を ⾏ う ⽅ 法 と ， 霧 吹  きなどの 散 布 機 構 で 花 粉 の 溶 液 を 吹 き 付 ける ⽅ 法 が 存 在 している ． 現 在 では 接 触 感 染 する 病 気 を 予 防 する ⽬ 的 などか  ら 後 者 の 散 布 ⼿ 法 が 好 まれているが ， いずれにしても 従 来 の 機 構 を 電 気 制 御 可 能 に 改 造 することで 実 現 可 能 であると  考 えられる ．